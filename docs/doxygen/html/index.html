<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ocarina of Time Source: The Legend of Zelda: Ocarina of Time</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ocarina of Time Source
   &#160;<span id="projectnumber">MQ-E-DBG</span>
   </div>
   <div id="projectbrief">A decompilation of Ocarina of Time: Master Quest (debug) brought to you by a bunch of clever folks.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The Legend of Zelda: Ocarina of Time </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line">- WARNING! -</div>
<div class="line"> </div>
<div class="line">The ROM this repository builds cannot be &#39;shifted&#39;, primarily due to some hardcoded pointers which have yet</div>
<div class="line">to be dumped. Thus this repository is currently in an experimental and research phase and cannot yet be used</div>
<div class="line">traditionally as a source code base for general changes.</div>
</div><!-- fragment --><p>This is a WIP decompilation of The Legend of Zelda: Ocarina of Time. The purpose of the project is to recreate a source code base for the game from scratch, using information found inside the game along with static and/or dynamic analysis. The only build currently supported is Master Quest (Debug), but other versions are planned to be supported.</p>
<p>It builds the following ROM:</p>
<ul>
<li>zelda_ocarina_mq_dbg.z64 <code>md5: f0b7f35375f9cc8ca1b2d59d78e35405</code></li>
</ul>
<p><b><a class="el" href="db/dfe/structNote.html">Note</a>:</b> This repository does not include any of the assets necessary to build the ROM. A prior copy of the game is required to extract the needed assets.</p>
<p>Website: <a href="https://zelda64.dev/">https://zelda64.dev/</a></p>
<p>Discord: <a href="https://discord.zelda64.dev">https://discord.zelda64.dev</a></p>
<h1>Installation</h1>
<h2>Windows</h2>
<p>For Windows 10, install WSL and a distribution by following this <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">Windows Subsystem for Linux Installation Guide</a>. We recommend using Debian or Ubuntu 18.04 Linux distributions.</p>
<p>For older versions of Windows, install a Linux VM or refer to <a href="#Docker">Docker</a> instructions.</p>
<h2>macOS</h2>
<p>For macOS, install a Linux VM or refer to <a href="#Docker">Docker</a> instructions.</p>
<h2>Linux (Native or under WSL / VM)</h2>
<h3>1. Install build dependencies</h3>
<p>The build process has the following package requirements:</p>
<ul>
<li>git</li>
<li>build-essential</li>
<li>binutils-mips-linux-gnu</li>
<li>python3</li>
</ul>
<p>Under Debian / Ubuntu (which we recommend using), you can install them with the following commands:</p>
<div class="fragment"><div class="line">sudo apt-get update</div>
<div class="line">sudo apt-get install git build-essential binutils-mips-linux-gnu python3</div>
</div><!-- fragment --><h3>2. Download qemu-irix</h3>
<p>Download qemu-irix from the Releases section in the repository. Place it at a location of your choosing.</p>
<h3>3. Set environment variables</h3>
<p>Open up your .bashrc file (~/.bashrc), scroll to the bottom, and add the following, replacing the paths as necessary:</p>
<div class="fragment"><div class="line">export QEMU_IRIX=&quot;path/to/your/qemu-irix&quot;</div>
<div class="line">export MIPS_BINUTILS_PREFIX=mips-linux-gnu-</div>
</div><!-- fragment --><p>Save and close/reopen your terminal window.</p>
<h3>4. Clone the repository</h3>
<p>Clone <code><a href="https://github.com/zeldaret/oot.git">https://github.com/zeldaret/oot.git</a></code> where you wish to have the project, with a command such as:</p>
<div class="fragment"><div class="line">git clone https://github.com/zeldaret/oot.git</div>
</div><!-- fragment --><h3>5. Prepare a base ROM</h3>
<p>Copy over your copy of the Master Quest (Debug) ROM inside the root of this new project directory. Rename the file to "baserom_original.z64" or "baserom_original.n64", depending on the original extension.</p>
<h3>6. Setup the ROM and build process</h3>
<p>Setup and extract everything from your ROM with the following command:</p>
<div class="fragment"><div class="line">make setup</div>
</div><!-- fragment --><p>This will generate a new ROM called "baserom.z64" that will have the overdump removed and the header patched. It will also extract the individual assets from the ROM.</p>
<h3>7. Build the ROM</h3>
<p>Run make to build the ROM. Make sure your path to the project is not too long, otherwise this process may error.</p>
<div class="fragment"><div class="line">make</div>
</div><!-- fragment --><p>If all goes well, a new ROM called "zelda_ocarina_mq_debug.z64" should be built and the following text should be printed:</p>
<div class="fragment"><div class="line">zelda_ocarina_mq_dbg.z64: OK</div>
</div><!-- fragment --><p>If you instead see the following:</p>
<div class="fragment"><div class="line">zelda_ocarina_mq_dbg.z64: FAILED</div>
<div class="line">md5sum: WARNING: 1 computed checksum did NOT match</div>
</div><!-- fragment --><p>This means that the built ROM isn't the same as the base one, so something went wrong or some part of the code doesn't match.</p>
<h2>Docker</h2>
<h3>1. Setup requirements</h3>
<p>To use Docker, you'll need either Docker Desktop or Docker Toolbox installed and setup based on your system.</p>
<p>You'll also need to prepare a local version of the project with a copied base ROM (see Step 4 and 5 of the Linux instructions).</p>
<h3>2. Create the docker image</h3>
<p>From inside your local project, run the following command:</p>
<div class="fragment"><div class="line">docker build . -t oot</div>
</div><!-- fragment --><h3>3. Start the container</h3>
<h4>Option A: With docker run</h4>
<p>To start the container, you can mount your local filesystem into the docker container and run an interactive bash session.</p>
<div class="fragment"><div class="line">docker run -it --rm --mount type=bind,source=&quot;$(pwd)&quot;,destination=/oot oot /bin/bash</div>
</div><!-- fragment --><h4>Option B (only for macOS): With docker-sync</h4>
<p>Prerequisite for this option: Install docker-sync with <code>gem install docker-sync</code></p>
<p>To start docker-sync and the development container, use <code>docker-sync-stack start</code></p>
<p>After a lot of waiting, you'll see something like "Attaching to oot_oot_1". This means the container is ready.</p>
<p>Then it's time to log into the container to begin working. <a class="el" href="db/dfe/structNote.html">Note</a> that this will be done in another tab while you leave the docker-sync tab going.</p>
<p>To get the container id, use <code>docker container ls</code> and use the ID from the container with image oot:latest in the following command:</p>
<p><code>docker exec-it &lt;CONTAINER-ID&gt; /bin/bash</code> You're in.</p>
<blockquote class="doxtable">
<p><a class="el" href="db/dfe/structNote.html">Note</a>: When done working, type Ctrl+c on the docker-sync tab to close the container and docker-sync. </p>
</blockquote>
<h3>4. Setup and Build the ROM</h3>
<p>Once inside the container, you can follow Step 6 and 7 of the Linux instructions to setup and build the ROM, or run any other command you need.</p>
<h1>Contributing</h1>
<p>All contributions are welcome. This is a group effort, and even small contributions can make a difference. Some tasks also don't require much knowledge to get started.</p>
<p>Most discussions happen on our <a href="https://discord.zelda64.dev">Discord Server</a>, where you are welcome to ask if you need help getting started, or if you have any questions regarding this project and other decompilation projects. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
